(function(e){function t(t){for(var s,r,i=t[0],c=t[1],l=t[2],u=0,d=[];u<i.length;u++)r=i[u],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&d.push(a[r][0]),a[r]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);m&&m(t);while(d.length)d.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],s=!0,r=1;r<n.length;r++){var i=n[r];0!==a[i]&&(s=!1)}s&&(o.splice(t--,1),e=c(c.s=n[0]))}return e}var s={},r={app:0},a={app:0},o=[];function i(e){return c.p+"js/"+({}[e]||e)+"."+{"chunk-5cda7fe3":"23e718f7"}[e]+".js"}function c(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n={"chunk-5cda7fe3":1};r[e]?t.push(r[e]):0!==r[e]&&n[e]&&t.push(r[e]=new Promise((function(t,n){for(var s="css/"+({}[e]||e)+"."+{"chunk-5cda7fe3":"e7b4e920"}[e]+".css",a=c.p+s,o=document.getElementsByTagName("link"),i=0;i<o.length;i++){var l=o[i],u=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(u===s||u===a))return t()}var d=document.getElementsByTagName("style");for(i=0;i<d.length;i++){l=d[i],u=l.getAttribute("data-href");if(u===s||u===a)return t()}var m=document.createElement("link");m.rel="stylesheet",m.type="text/css",m.onload=t,m.onerror=function(t){var s=t&&t.target&&t.target.src||a,o=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=s,delete r[e],m.parentNode.removeChild(m),n(o)},m.href=a;var f=document.getElementsByTagName("head")[0];f.appendChild(m)})).then((function(){r[e]=0})));var s=a[e];if(0!==s)if(s)t.push(s[2]);else{var o=new Promise((function(t,n){s=a[e]=[t,n]}));t.push(s[2]=o);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,c.nc&&u.setAttribute("nonce",c.nc),u.src=i(e);var d=new Error;l=function(t){u.onerror=u.onload=null,clearTimeout(m);var n=a[e];if(0!==n){if(n){var s=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+s+": "+r+")",d.name="ChunkLoadError",d.type=s,d.request=r,n[1](d)}a[e]=void 0}};var m=setTimeout((function(){l({type:"timeout",target:u})}),12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(t)},c.m=e,c.c=s,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)c.d(n,s,function(t){return e[t]}.bind(null,s));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/repositorioDespliegue/",c.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var m=u;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0136":function(e,t,n){"use strict";var s=n("8bdb"),r=n.n(s);r.a},"034f":function(e,t,n){"use strict";var s=n("85ec"),r=n.n(s);r.a},2150:function(e,t,n){"use strict";var s=n("4371"),r=n.n(s);r.a},"30a0":function(e,t,n){},"3b9b":function(e,t,n){},4371:function(e,t,n){},"556e":function(e,t,n){"use strict";var s=n("6076"),r=n.n(s);r.a},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var s=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("router-view")],1)},a=[],o=(n("4160"),n("159b"),n("c6f2")),i={name:"App",data:function(){return{usuarios:[]}},created:function(){},components:{},methods:{listUsers:function(){var e=this,t={name:"",lastName:"",email:"",password:"",active:""};o.usuarios.get().then((function(n){n.forEach((function(n){var s=n.data();t={name:s.nombre,lastName:s.apellido,email:s.email,password:s.contraseña,active:s.activo},e.usuarios.push(t)}))})),console.log(this.usuarios)}}},c=i,l=(n("034f"),n("2877")),u=Object(l["a"])(c,r,a,!1,null,null,null),d=u.exports,m=(n("5363"),n("ce5b")),f=n.n(m);n("bf40");s["default"].use(f.a);var p={icons:{iconfont:"mdi"}},v=new f.a(p),h=n("8c4f"),g=n("5530"),b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"LoginContent"},[n("v-container",[n("v-row",{staticClass:"mx-2",attrs:{justify:"center"}},[n("v-col",{staticStyle:{background:"whitesmoke","border-radius":"20px",padding:"25px",border:"2px solid white"},attrs:{xs:"10",sm:"10",md:"5",lg:"5",xl:"5"}},[n("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("h1",[e._v("Inicio de Sesión")]),n("br"),n("v-text-field",{attrs:{rules:e.emailRules,label:"E-mail",required:""},on:{keyup:function(t){return t.type.indexOf("key")||13===t.keyCode?e.formSubmit(t):null}},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),n("v-text-field",{attrs:{"append-icon":e.showPassword?"mdi-eye":"mdi-eye-off",type:e.showPassword?"text":"password",label:"Password",rules:e.passwordRules},on:{keyup:function(t){return t.type.indexOf("key")||13===t.keyCode?e.formSubmit(t):null},"click:append":function(t){e.showPassword=!e.showPassword}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),n("p",[e._v(" ¿No tienes una cuenta?, "),n("router-link",{staticClass:"linkStyle",attrs:{to:"/signup"}},[e._v("Regístrate")])],1),n("br"),n("br"),n("v-btn",{staticStyle:{margin:"10px",background:"#08799C"},attrs:{color:"primary"},on:{click:e.findUser}},[e._v("Ingresar")])],1)],1)],1)],1)],1)},w=[],x=n("69f2"),k=n.n(x),_=n("2f62"),C=n("c6f2"),I={name:"Login",data:function(){return{user:void 0,showPassword:!1,email:"",password:"",valid:!1,msg:"",emailRules:[function(e){return!!e||"El correo electrónico es obligatorio"}],passwordRules:[function(e){return!!e||"La contraseña es obligatoria"}]}},methods:Object(g["a"])({},Object(_["b"])(["setPersonId","setPersonFirstName","setPersonLastName","isActive","setCurrentRol"]),{findUser:function(){var e=this,t=k()("sha512").update(this.password).digest("hex");console.log(t),C.db.collection("usuarios").where("email","==",this.email).where("contraseña","==",t).get().then((function(t){t.forEach((function(t){e.setPersonId(t.id),e.setPersonFirstName(t.data().nombre),e.setPersonLastName(t.data().apellido),e.setCurrentRol(t.data().rol),e.isActive(t.data().activo);var n=e.$store.state.person.currentRole;if("administrador"==n){var s="Admin";e.$router.push({name:s})}else if("usuario"==n){var r="User";e.$router.push({name:r})}}))})).catch((function(e){console.log(e),console.log("Errro")})),console.log(this.$store.state.person)}})},y=I,O=(n("825d"),Object(l["a"])(y,b,w,!1,null,null,null)),E=O.exports,j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"registerContent"},[n("v-container",[n("v-row",{staticClass:"mx-2",attrs:{justify:"center"}},[n("v-col",{staticStyle:{background:"whitesmoke","border-radius":"20px",border:"2px solid white",padding:"25px"},attrs:{xs:"12",sm:"12",md:"6"}},[n("h1",[e._v(e._s(e.title))]),n("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{md:"5",sm:"12"}},[n("v-text-field",{attrs:{rules:e.nameRules,label:"Nombres",required:""},model:{value:e.names,callback:function(t){e.names=t},expression:"names"}})],1),n("v-col",{attrs:{md:"5",sm:"12"}},[n("v-text-field",{attrs:{rules:e.lastnamesRules,label:"Apellidos",required:""},model:{value:e.lastnames,callback:function(t){e.lastnames=t},expression:"lastnames"}})],1)],1),n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{md:"6",sm:"12"}},[n("v-text-field",{attrs:{rules:e.emailRules,label:"Correo",required:""},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),n("v-text-field",{staticClass:"input-group--focused",attrs:{"append-icon":e.showPassword?"mdi-eye":"mdi-eye-off",rules:[e.rules.required,e.rules.emailMatch],type:e.showPassword?"text":"password",name:"input-10-2",label:"Contraseña",hint:"Mínimo 8 caracteres",value:"",required:""},on:{"click:append":function(t){e.showPassword=!e.showPassword}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),n("v-text-field",{staticClass:"input-group--focused",attrs:{"append-icon":e.showConPassword?"mdi-eye":"mdi-eye-off",rules:[e.rules.required,e.rules.samePassword],type:e.showConPassword?"text":"password",name:"input-10-2",label:"Confirmar contraseña",hint:"Mínimo 8 caracteres",value:"",required:""},on:{"click:append":function(t){e.showConPassword=!e.showConPassword}},model:{value:e.conPassword,callback:function(t){e.conPassword=t},expression:"conPassword"}})],1)],1),n("v-row",{attrs:{justify:"center"}},[n("v-col",{attrs:{md:"3",sm:"12"}},[n("v-btn",{staticStyle:{margin:"5px",background:"#08799C"},attrs:{disabled:e.disabledButtonRegister,color:"primary"},on:{click:function(t){return e.sendRegisterData()}}},[e._v("Registrarse")])],1)],1)],1)],1)],1)],1)],1)},R=[],P=n("c6f2"),N={name:"Register",data:function(){var e=this;return{COLLECTION:"usuarios",title:"Registro",names:"",lastnames:"",email:"",password:"",conPassword:"",showPassword:!1,showConPassword:!1,rules:{required:function(e){return!!e||"Required."},min:function(e){return e.length>=8||"Min 8 characters"},samePassword:function(t){return t===e.password||"Las contraseñas no coinciden"}},nameRules:[function(e){return!!e||"El nombre es requerido"},function(e){return e.length>2||"El nombre debe ser más largo a 3 caracteres"}],lastnameRules:[function(e){return!!e||"El apellido es requerido"},function(e){return e.length>3||"El apellido debe ser más largo a 3 caracteres"}],emailRules:[function(e){return!!e||"El correo es requerido"},function(e){return/^[a-zA-Z0-9_.+-]+@(correo.icesi.edu|icesi.edu)\.co$/.test(e)||"El correo no es valido"}]}},computed:{disabledButtonRegister:function(){return!this.names&&!this.lastname&&!this.email&&!this.password&&this.conPassword===this.password}},methods:{sendRegisterData:function(){P.db.collection(this.COLLECTION).add({"contraseña":k()("sha512").update(this.password).digest("hex"),apellido:this.lastnames,nombre:this.names,email:this.email,activo:!1}).then((function(e){console.log("Document written with ID: ",e.id),alert("Usuario registrado exitosamente"),this.$router.push("/login")})).catch((function(e){console.error("Error adding document: ",e)}))}}},M=N,D=(n("7247"),Object(l["a"])(M,j,R,!1,null,null,null)),F=D.exports,$=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"adminContent"},[n("navBar",{attrs:{items:e.items}}),n("router-view")],1)},S=[],q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"div-top"},[n("v-app-bar",{attrs:{color:"#0FB066",dense:"",dark:""}},[n("v-toolbar-title",[e._v("Foros web")]),n("v-spacer"),n("div",{staticClass:"userInfo"},[n("p",{staticClass:"name"},[e._v(e._s(e.name))]),n("v-menu",{attrs:{bottom:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[n("v-btn",e._g({staticClass:"logo",attrs:{icon:"",color:"yellow"}},s),[n("v-list-item-avatar",[n("v-img",{attrs:{src:"https://randomuser.me/api/portraits/men/85.jpg"}})],1)],1)]}}])},[n("v-list",[e._l(e.items,(function(t,s){return n("v-list-item",{key:s,attrs:{link:"",to:{name:t.link}}},[n("v-list-item-icon",[n("v-icon",[e._v(e._s(t.icon))])],1),n("v-list-item-content",[n("v-list-item-title",[e._v(e._s(t.title))])],1)],1)})),n("v-list-item",{attrs:{link:""},on:{click:function(t){return e.logout()}}},[n("v-list-item-icon",[n("v-icon",[e._v("mdi-close-circle")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("Cerrar sesión")])],1)],1)],2)],1)],1)],1)],1)},T=[],A=void 0,L={data:function(){return{name:A.$store.state.person.id}},props:["items"],methods:Object(g["a"])({},Object(_["b"])(["resetPersonState"]),{logout:function(){this.resetPersonState(),this.$router.push("/login")}})},U=L,B=(n("bcc6"),Object(l["a"])(U,q,T,!1,null,null,null)),z=B.exports,J={name:"Admin",data:function(){return{items:[{title:"Gestión usuarios",icon:"mdi-account-multiple",link:"userManagement"},{title:"Gestión de temas",icon:"mdi-file-document",link:"topicManagement"}]}},components:{navBar:z}},G=J,V=(n("2150"),Object(l["a"])(G,$,S,!1,null,null,null)),H=V.exports,K=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"userManagementContent"},[n("v-card",{staticStyle:{width:"100%"}},[n("v-card-title",[e._v(" Usuarios "),n("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),n("v-spacer"),n("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Buscar","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),n("v-data-table",{staticClass:"elevation-1",attrs:{"no-data-text":"No hay usuarios por el momento",headers:e.headers,items:e.users,"sort-by":"firstName",search:e.search},scopedSlots:e._u([{key:"top",fn:function(){return[n("v-toolbar",{attrs:{flat:"",color:"white"}},[n("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[n("v-btn",e._g({staticClass:"mb-2",attrs:{color:"primary",dark:""}},s),[e._v("Nuevo Usuario")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline"},[e._v(e._s(e.formTitle))])]),n("v-card-text",[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12",sm:"6",md:"6"}},[n("v-text-field",{attrs:{rules:e.nameRules,label:"Nombre",outlined:"",required:""},model:{value:e.editedItem.firstName,callback:function(t){e.$set(e.editedItem,"firstName",t)},expression:"editedItem.firstName"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"6"}},[n("v-text-field",{attrs:{rules:e.lastnameRules,label:"Apellido",outlined:"",required:""},model:{value:e.editedItem.lastName,callback:function(t){e.$set(e.editedItem,"lastName",t)},expression:"editedItem.lastName"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"6"}},[n("v-checkbox",{staticClass:"mx-2",attrs:{label:"¿Está Activo?",required:""},model:{value:e.editedItem.active,callback:function(t){e.$set(e.editedItem,"active",t)},expression:"editedItem.active"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"6"}},[n("v-text-field",{attrs:{rules:e.emailRules,label:"Email",outlined:"",required:""},model:{value:e.editedItem.email,callback:function(t){e.$set(e.editedItem,"email",t)},expression:"editedItem.email"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"6"}},[n("v-combobox",{attrs:{items:e.items,label:"Rol",chips:""},model:{value:e.editedItem.rol,callback:function(t){e.$set(e.editedItem,"rol",t)},expression:"editedItem.rol"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"6"}},[n("div")]),n("v-col",{directives:[{name:"show",rawName:"v-show",value:-1===e.editedIndex,expression:"editedIndex === -1"}],attrs:{cols:"12",sm:"6",md:"6"}},[n("v-text-field",{staticClass:"input-group--focused",attrs:{"append-icon":e.showPassword?"mdi-eye":"mdi-eye-off",rules:[e.rules.required,e.rules.min],type:e.showPassword?"text":"password",name:"input-10-2",hint:"Mínimo 8 caracteres",value:"",label:"Contraseña",outlined:"",required:""},on:{"click:append":function(t){e.showPassword=!e.showPassword}},model:{value:e.editedItem.password,callback:function(t){e.$set(e.editedItem,"password",t)},expression:"editedItem.password"}})],1),n("v-col",{directives:[{name:"show",rawName:"v-show",value:-1===e.editedIndex,expression:"editedIndex === -1"}],attrs:{cols:"12",sm:"6",md:"6"}},[n("v-text-field",{staticClass:"input-group--focused",attrs:{"append-icon":e.showConPassword?"mdi-eye":"mdi-eye-off",rules:[e.rules.required,e.rules.samePassword],type:e.showConPassword?"text":"password",name:"input-10-2",label:"Confirmar contraseña",hint:"Mínimo 8 caracteres",value:"",outlined:"",required:""},on:{"click:append":function(t){e.showConPassword=!e.showConPassword}},model:{value:e.editedItem.conPassword,callback:function(t){e.$set(e.editedItem,"conPassword",t)},expression:"editedItem.conPassword"}})],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"error",text:""},on:{click:e.close}},[e._v("Cancelar")]),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.save}},[e._v("Guardar")])],1)],1)],1)],1)]},proxy:!0},{key:"item.action",fn:function(t){var s=t.item;return[n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(s)}}},[e._v("mdi-pencil")]),n("v-icon",{attrs:{small:""},on:{click:function(t){return e.deleteItem(s)}}},[e._v("mdi-delete")])]}}])})],1)],1)},Y=[],Z=(n("c975"),n("a434"),n("96cf"),n("1da1")),Q=n("c6f2"),W={name:"userManagement",data:function(){var e=this;return{users:[],search:"",dialog:!1,headers:[{text:"Nombre",align:"left",sortable:!1,value:"firstName"},{text:"Apellido",value:"lastName"},{text:"Email",value:"email"},{text:"Mensajes",value:"messages"},{text:"Activo",value:"active"},{text:"Rol",value:"rol"},{text:"Acciones",value:"action",sortable:!1}],items:["administrador","usuario"],editedIndex:-1,editedItem:{id:"",firstName:"",lastName:"",email:"",active:!1,messages:0,rol:"",password:"",conPassword:""},defaultItem:{id:"",firstName:"",lastName:"",messages:0,email:"",rol:""},showPassword:!1,showConPassword:!1,rules:{required:function(e){return!!e||"Required."},min:function(e){return e.length>=8||"Min 8 characters"},samePassword:function(t){return t===e.editedItem.password||"Las contraseñas no coinciden"}},nameRules:[function(e){return!!e||"El nombre es requerido"},function(e){return e.length>2||"El nombre debe ser más largo a 3 caracteres"}],lastnameRules:[function(e){return!!e||"El apellido es requerido"},function(e){return e.length>3||"El apellido debe ser más largo a 3 caracteres"}],emailRules:[function(e){return!!e||"El correo es requerido"},function(e){return/^[a-zA-Z0-9_.+-]+@(correo.icesi.edu|icesi.edu)\.co$/.test(e)||"El correo no es valido"}]}},computed:{formTitle:function(){return-1===this.editedIndex?"Nuevo Usuario":"Editar Usuario"}},watch:{dialog:function(e){e||this.close()}},created:function(){this.initialize()},methods:{initialize:function(){this.getUsers()},save:function(){var e=this;return Object(Z["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.editedIndex>-1?(Object.assign(e.users[e.editedIndex],e.editedItem),e.updateUser(e.editedIndex)):(e.saveUser(e.editedItem),e.users.push(e.editedItem)),e.close();case 2:case"end":return t.stop()}}),t)})))()},saveUser:function(e){return Object(Z["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n={nombre:e.firstName,apellido:e.lastName,email:e.email,activo:e.active,"contraseña":k()("sha512").update(e.password).digest("hex")},Q.db.collection("usuarios").add(n).then((function(e){console.log("Document written with ID: ",e.id)})).catch((function(e){console.error("Error adding document: ",e)}));case 2:case"end":return t.stop()}}),t)})))()},updateUser:function(e){var t=this.users[e],n={nombre:t.firstName,apellido:t.lastName,email:t.email,activo:t.active};Q.db.collection("usuarios").doc(t.id).update(n).then((function(){console.log("Document successfully updated!")})).catch((function(e){console.error("Error updating document: ",e)}))},editItem:function(e){this.editedIndex=this.users.indexOf(e),this.editedItem=Object.assign({},e),this.dialog=!0},deleteItem:function(e){var t=this.users.indexOf(e);0==e.messages?confirm("¿Esta seguro que desea eliminar este usuario?")&&this.deleteUser(e)&&this.users.splice(t,1):confirm("No es posible eliminar el usuario al tener mensajes relacionados")},deleteUser:function(e){return Object(Z["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Q.db.collection("usuarios").doc(e.id).delete().then((function(){alert("Document successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)}));case 2:case"end":return t.stop()}}),t)})))()},close:function(){var e=this;this.dialog=!1,this.showPassword=!1,this.showPassword=!1,setTimeout((function(){e.editedItem=Object.assign({},e.defaultItem),e.editedIndex=-1}),300)},getUsers:function(){var e=this;return Object(Z["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={id:"",firstName:"",lastName:"",email:"",password:"",messages:0,active:"",rol:""},t.next=3,Q.db.collection("usuarios").get().then((function(t){t.forEach((function(t){var s=t.data();n={firstName:s.nombre,lastName:s.apellido,email:s.email,password:s.contraseña,active:s.activo,rol:s.rol,id:t.id},e.users.push(n)}))}));case 3:e.getNumberOfMessages();case 4:case"end":return t.stop()}}),t)})))()},getNumberOfMessages:function(){var e=this;return Object(Z["a"])(regeneratorRuntime.mark((function t(){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(n=function(){var t=e.users[s];Q.db.collection("mensajes").where("usuario","==",t.id+"").get().then((function(e){t.messages=e.size,console.log(t.messages)}))},s=0;s<e.users.length;s++)n();case 2:case"end":return t.stop()}}),t)})))()}}},X=W,ee=(n("7cc6"),Object(l["a"])(X,K,Y,!1,null,null,null)),te=ee.exports,ne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"GeneralForumContent"},[n("div",{staticClass:"serchForums"},[n("v-row",[n("v-col",{attrs:{xs:"11",xl:"11",sm:"11",lg:"11",md:"11"}},[n("v-autocomplete",{staticClass:"mx-4",attrs:{loading:e.loading,items:e.topics.title,"search-input":e.search,"cache-items":"",flat:"","hide-no-data":"","hide-details":"",label:"Busca un tema","solo-inverted":""},on:{"update:searchInput":function(t){e.search=t},"update:search-input":function(t){e.search=t}},model:{value:e.select,callback:function(t){e.select=t},expression:"select"}})],1),n("v-col",[n("v-btn",{staticClass:"mx-2 add",attrs:{fab:"",dark:"",color:"#0FB066"},on:{click:function(t){e.dialog=!0}}},[n("v-icon",{attrs:{dark:""}},[e._v("mdi-plus")])],1)],1)],1)],1),n("div",{staticClass:"forums"},[n("v-row",e._l(e.forums,(function(t){return n("v-col",{key:t.title,attrs:{md:"3",lg:"3",sm:"3",xl:"3",xs:"3"}},[n("div",{staticClass:"forum"},[n("v-card",{staticClass:"mx-auto",attrs:{color:"#0F4176",dark:"",outlined:"","max-width":"400"}},[n("v-card-title",[n("span",{staticClass:"title font-weight-light"},[e._v(e._s(t.title))])]),n("v-card-text",{staticClass:"headline font-weight-bold"},[e._v(e._s(t.description))]),n("v-card-actions",[n("v-list-item",{staticClass:"grow"},[n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-btn",{staticClass:"goForum",attrs:{color:"#0FB066",to:{name:"forumDiscussion",params:{forum:t}}}},[e._v(" Ir al foro")])],1)],1)],1)],1)],1)])})),1)],1),n("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline"},[e._v("Añadir Foro")])]),n("v-card-text",[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[n("v-text-field",{attrs:{label:"Titulo",outlined:"",required:""},model:{value:e.forum.title,callback:function(t){e.$set(e.forum,"title",t)},expression:"forum.title"}})],1),n("v-col",[n("v-combobox",{attrs:{items:e.topics,"item-text":"title","item-value":"topic.id",label:"Tema",chips:""},model:{value:e.forum.topic,callback:function(t){e.$set(e.forum,"topic",t)},expression:"forum.topic"}})],1),n("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[n("v-textarea",{attrs:{outlined:"",name:"input-7-4",label:"Descripción"},model:{value:e.forum.description,callback:function(t){e.$set(e.forum,"description",t)},expression:"forum.description"}})],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"error",text:""},on:{click:e.close}},[e._v("Cancelar")]),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.save}},[e._v("Guardar")])],1)],1)],1)],1)},se=[],re=(n("a4d3"),n("e01a"),n("4de4"),n("c6f2")),ae={data:function(){return{forum:{topic:"",title:"",description:""},forums:[],topics:[],loading:!1,search:null,select:null,dialog:!1,topicSelected:[]}},mounted:function(){this.maxCharDescription(),this.getTopics()},watch:{search:function(e){e&&e!==this.select&&this.querySelections(e)}},methods:{getForums:function(){var e=this;re.db.collection("foros").get().then((function(t){t.forEach((function(t){var n=t.data(),s={id:t.id,user:n.usuario,description:n.descripcion,topic:n.tema,date:n.fecha,title:n.titulo},r=s.description+"";s.description=r.substring(0,100)+" ...",e.forums.push(s)}))}))},maxCharDescription:function(){this.getForums()},querySelections:function(e){var t=this;this.loading=!0,setTimeout((function(){t.topics=t.topics.filter((function(t){return console.log(t),(t.title+""||"").toLowerCase().indexOf((e||"").toLowerCase())>-1})),t.loading=!1}),500)},getTopics:function(){var e=this;re.db.collection("temas").get().then((function(t){t.forEach((function(t){var n=t.data(),s={id:t.id,description:n.descripcion+"",title:n.titulo+""};e.topics.push(s)}))}))},save:function(){this.forum.topic=this.forum.topic.id,re.db.collection("foros").add({titulo:this.forum.title,descripcion:this.forum.description,tema:this.forum.topic,usuario:this.$store.state.person.id,fecha:new Date}).then((function(e){console.log("Document written with ID: ",e.id)})).catch((function(e){console.error("Error adding document: ",e)})),this.close()},close:function(){this.forum.title="",this.forum.topic="",this.forum.description="",this.dialog=!1}}},oe=ae,ie=(n("a4b8"),Object(l["a"])(oe,ne,se,!1,null,null,null)),ce=ie.exports,le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"userContent"},[n("navBar",{attrs:{items:e.items}}),n("router-view")],1)},ue=[],de={name:"user",data:function(){return{items:[{title:"Foros",icon:"mdi-message-text-outline",link:"generalForum"}]}},components:{navBar:z}},me=de,fe=(n("b02c"),Object(l["a"])(me,le,ue,!1,null,null,null)),pe=fe.exports,ve=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"forumDiscussionContent"},[n("div",{staticClass:"forum"},[n("v-card",{staticClass:"mx-auto",attrs:{outlined:""}},[n("v-card-title",[n("v-icon",{attrs:{large:"",left:""}},[e._v("mdi-twitter")]),n("span",{staticClass:"title font-weight-light"},[e._v(e._s(e.forum.title))])],1),n("v-card-subtitle",{staticClass:"pb-0"},[n("span",[e._v("Creado por : "+e._s(e.forum.user)+" - "+e._s(e.forum.date))])]),n("v-card-text",{staticClass:"text--primary"},[e._v("Descripción: "+e._s(e.forum.description))]),n("v-card-actions",[n("v-btn",{attrs:{color:"purple",text:""},on:{click:function(t){e.dialog=!0}}},[e._v("Responder")])],1)],1),n("v-row",{attrs:{justify:"center"}},[n("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline"},[e._v(e._s(e.forum.title))])]),n("v-card-subtitle",[e._v("En respuesta a : "+e._s(e.forum.user)+" - "+e._s(e.forum.date))]),n("v-card-text",[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[n("v-textarea",{attrs:{outlined:"",name:"input-7-4",label:"Descripción"},model:{value:e.item.content,callback:function(t){e.$set(e.item,"content",t)},expression:"item.content"}})],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v("Close")]),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){return e.save()}}},[e._v("Save")])],1)],1)],1)],1)],1),n("div",{staticClass:"forumDiscussion"},[n("TreeView",{attrs:{messages:e.messagesOfForum}})],1)])},he=[],ge=(n("7db0"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"treeViewContent"},e._l(e.messages,(function(e){return n("div",{key:e.id},[n("treeFolder",{staticClass:"tree",attrs:{message:e}})],1)})),0)}),be=[],we=n("bff9"),xe={name:"TreeView",data:function(){return{}},props:["messages"],components:{treeFolder:we["a"]}},ke=xe,_e=Object(l["a"])(ke,ge,be,!1,null,null,null),Ce=_e.exports,Ie=n("c6f2"),ye={name:"forumDiscussion",data:function(){return{dialog:!1,messagesOfForum:[],parentMessages:[],item:{id:"",content:"",forum:"",date:"",parentMessages:"",user:"",children:[]}}},props:["forum"],components:{TreeView:Ce},mounted:function(){this.getUserOfForum(),this.getMessages()},created:function(){},computed:{},methods:{getUserOfForum:function(){var e=this;return Object(Z["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.forum,t.next=3,Ie.db.collection("usuarios").doc(n.user).get().then((function(t){var n=t.data();e.forum.user=n.nombre+" "+n.apellido;var s=e.timeConverter(e.forum.date);e.forum.date=s}));case 3:case"end":return t.stop()}}),t)})))()},timeConverter:function(e){var t=new Date,n=new Date(1e3*e),s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=t.getFullYear(),a=s[n.getMonth()],o=n.getDate(),i=n.getHours(),c=n.getMinutes(),l=n.getSeconds(),u=o+" "+a+" "+r+" "+i+":"+c+":"+l;return u},getMessages:function(){var e=this;return Object(Z["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={id:"",content:"",date:"",forum:"",parent_message:"",user:"",children:[]},t.next=3,Ie.db.collection("mensajes").where("foro","==",e.forum.id+"").get().then((function(t){t.forEach((function(t){var s=t.data();n={content:s.contenido,date:s.fecha,forum:s.foro,parent_message:s.mensaje_padre,user:s.usuario,id:t.id,children:s.children};var r=e.timeConverter(n.date);n.date=r,e.messagesOfForum.push(n)}))}));case 3:e.getParentsMessages();case 4:case"end":return t.stop()}}),t)})))()},getParentsMessages:function(){var e=this;return Object(Z["a"])(regeneratorRuntime.mark((function t(){var n,s,r,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(n=0;n<e.messagesOfForum.length;n++)for(s=e.messagesOfForum[n],r=[],r=s.children,a=function(){var t=r[o],n=e.messagesOfForum.find((function(e){return e.id==t}));s.children[o]=n},o=0;o<r.length;o++)a();case 1:case"end":return t.stop()}}),t)})))()},save:function(){var e=this;return Object(Z["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={contenido:e.item.content,fecha:new Date,foro:e.forum.id,mensaje_padre:"",usuario:e.$store.state.person.id,children:[]},t.next=3,Ie.db.collection("mensajes").add(n).then((function(e){console.log("Document written with ID: ",e.id)})).catch((function(e){console.error("Error adding document: ",e)}));case 3:e.close(),e.$router.push({name:"generalForum"});case 5:case"end":return t.stop()}}),t)})))()},close:function(){this.item.content="",this.dialog=!1,this.getMessages()}}},Oe=ye,Ee=(n("a6ef"),Object(l["a"])(Oe,ve,he,!1,null,null,null)),je=Ee.exports,Re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"topicManagementContent"},[n("v-data-table",{staticClass:"elevation-1",attrs:{"no-data-text":"No hay temas por el momento",headers:e.headers,items:e.topics,"sort-by":"title"},scopedSlots:e._u([{key:"top",fn:function(){return[n("v-toolbar",{attrs:{flat:"",color:"white"}},[n("v-toolbar-title",[e._v("Temas")]),n("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),n("v-spacer"),n("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[n("v-btn",e._g({staticClass:"mb-2",attrs:{color:"primary",dark:""}},s),[e._v("Nuevo tema")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline"},[e._v(e._s(e.formTitle))])]),n("v-card-text",[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12",sm:"6",md:"6"}},[n("v-text-field",{attrs:{rules:e.titleRules,label:"Titulo",outlined:"",required:""},model:{value:e.editedItem.title,callback:function(t){e.$set(e.editedItem,"title",t)},expression:"editedItem.title"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"6"}},[n("v-text-field",{attrs:{rules:e.descriptionRules,label:"Descripcion",outlined:"",required:""},model:{value:e.editedItem.description,callback:function(t){e.$set(e.editedItem,"description",t)},expression:"editedItem.description"}})],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"error",text:""},on:{click:e.close}},[e._v("Cancelar")]),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.save}},[e._v("Guardar")])],1)],1)],1)],1)]},proxy:!0},{key:"item.action",fn:function(t){var s=t.item;return[n("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(s)}}},[e._v("mdi-pencil")]),n("v-icon",{attrs:{small:""},on:{click:function(t){return e.deleteItem(s)}}},[e._v("mdi-delete")])]}}])})],1)},Pe=[],Ne=n("c6f2"),Me={name:"topicsManagement",data:function(){return{COLLECTION:"temas",dialog:!1,topics:[],headers:[{text:"Titulo",align:"left",sortable:!1,value:"title"},{text:"Descripción",value:"description"},{text:"Acciones",value:"action"}],editedIndex:-1,editedItem:{id:"",title:"",description:""},defaultItem:{id:"",title:"",description:""},rules:{required:function(e){return!!e||"Required."},min:function(e){return e.length>=8||"Min 8 characters"}},titleRules:[function(e){return!!e||"El titulo es requerido"},function(e){return e.length>2||"El titulo debe ser más largo a 3 caracteres"}],descriptionRules:[function(e){return!!e||"El apellido es requerido"},function(e){return e.length>3||"El apellido debe ser más largo a 3 caracteres"}]}},computed:{formTitle:function(){return-1===this.editedIndex?"Nuevo tema":"Editar tema"}},watch:{dialog:function(e){e||this.close()}},created:function(){},mounted:function(){this.getTopics()},methods:{getTopics:function(){var e=this;Ne.db.collection("temas").get().then((function(t){t.forEach((function(t){var n=t.data(),s={id:t.id,description:n.descripcion+"",title:n.titulo+""};e.topics.push(s)}))}))},editItem:function(e){this.editedIndex=this.topics.indexOf(e),this.editedItem=Object.assign({},e),this.dialog=!0},deleteItem:function(e){Ne.db.collection(this.COLLECTION).doc(e.id).delete().then((function(){console.log("Document successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)}))},close:function(){var e=this;this.dialog=!1,this.showPassword=!1,this.showPassword=!1,setTimeout((function(){e.editedItem=Object.assign({},e.defaultItem),e.editedIndex=-1}),300)},save:function(){this.editedIndex>-1?(Object.assign(this.topics[this.editedIndex],this.editedItem),this.updateTopic(this.editedItem)):(this.saveTopic(this.editedItem),this.topics.push(this.editedItem)),this.close()},updateTopic:function(e){console.log(e.id);var t=Ne.db.collection(this.COLLECTION).doc(e.id);return t.update({titulo:e.title,descripcion:e.description}).then((function(){console.log("Document successfully updated!")})).catch((function(e){console.error("Error updating document: ",e)}))},saveTopic:function(e){Ne.db.collection(this.COLLECTION).add({titulo:e.title,descripcion:e.description}).then((function(e){console.log("Document written with ID: ",e.id)})).catch((function(e){console.error("Error adding document: ",e)}))}}},De=Me,Fe=(n("0136"),Object(l["a"])(De,Re,Pe,!1,null,null,null)),$e=Fe.exports;s["default"].use(h["a"]);var Se=new h["a"]({routes:[{path:"/",component:E},{path:"/login",component:E},{path:"/signup",component:F},{path:"/adminPane",component:H,name:"Admin",redirect:"/adminPane/userManagement",children:[{name:"userManagement",path:"userManagement",component:te},{name:"topicManagement",path:"topicManagement",component:$e}]},{path:"/userPane",component:pe,name:"User",redirect:"/userPane/generalForum",children:[{name:"generalForum",path:"generalForum",component:ce},{name:"forumDiscussion",path:"forumDiscussion",props:function(e){return Object(g["a"])({},e.params)},component:je}]}]}),qe=n("0e44");s["default"].use(_["a"]);var Te=function(){return{person:{id:"",firstName:"",lastName:"",currentRole:"",isActive:!1}}},Ae=new _["a"].Store({plugins:[Object(qe["a"])()],state:{person:{id:"",firstName:"",lastName:"",currentRole:"",isActive:!1}},mutations:{updateId:function(e,t){e.person.id=t},updateFirstName:function(e,t){e.person.firstName=t},updateLastName:function(e,t){e.person.lastName=t},updateCurrentRol:function(e,t){e.person.currentRole=t},updateIsActive:function(e,t){e.person.isActive=t},resetState:function(e){Object.assign(e,Te())}},actions:{setPersonId:function(e,t){var n=e.commit;n("updateId",t)},setPersonFirstName:function(e,t){var n=e.commit;n("updateFirstName",t)},setPersonLastName:function(e,t){var n=e.commit;n("updateLastName",t)},setCurrentRol:function(e,t){var n=e.commit;n("updateCurrentRol",t)},isActive:function(e,t){var n=e.commit;n("updateIsActive",t)},resetPersonState:function(e){var t=e.commit;t("resetState")}}}),Le=n("0ff2");s["default"].use(h["a"]),s["default"].use(Le["a"]),s["default"].config.productionTip=!1,new s["default"]({vuetify:v,router:Se,store:Ae,render:function(e){return e(d)}}).$mount("#app")},"5db1":function(e,t,n){},6076:function(e,t,n){},7247:function(e,t,n){"use strict";var s=n("a96c"),r=n.n(s);r.a},"7cc6":function(e,t,n){"use strict";var s=n("30a0"),r=n.n(s);r.a},"825d":function(e,t,n){"use strict";var s=n("3b9b"),r=n.n(s);r.a},"85ec":function(e,t,n){},"8bdb":function(e,t,n){},"9bd5":function(e,t,n){},a4b8:function(e,t,n){"use strict";var s=n("9bd5"),r=n.n(s);r.a},a6ef:function(e,t,n){"use strict";var s=n("f5b2"),r=n.n(s);r.a},a96c:function(e,t,n){},b02c:function(e,t,n){"use strict";var s=n("db5e"),r=n.n(s);r.a},bcc6:function(e,t,n){"use strict";var s=n("5db1"),r=n.n(s);r.a},bff9:function(e,t,n){"use strict";var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"treeFolder"},[n("v-card",{staticClass:"mx-auto"},[n("v-list-item",[n("v-list-item-avatar",{attrs:{color:"grey"}},[n("v-icon",[e._v("mdi-face")])],1),n("v-list-item-content",[n("v-list-item-title",{staticClass:"headline"},[e._v(e._s(this.message.user))]),n("v-list-item-subtitle",[e._v(e._s(this.message.date))])],1)],1),n("v-card-text",[n("span",[e._v(e._s(this.message.content)+" ")]),n("br"),n("br"),n("span",{staticClass:"subheading mr-2"},[e._v(" En respuesta a : "+e._s(e.parentMessage.user)+" - "+e._s(e.parentMessage.date))])]),n("v-card-actions",[n("v-row",{attrs:{align:"center",justify:"end"}},[n("v-col",[n("v-btn",{attrs:{text:"",color:"deep-purple accent-4"},on:{click:function(t){e.dialog=!0}}},[e._v(" Responder ")])],1),n("v-col",[n("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.currentUser===this.$store.state.person.id,expression:"currentUser === this.$store.state.person.id"}],attrs:{text:"",color:"deep-purple accent-4"},on:{click:function(t){return e.edit()}}},[e._v(" Editar ")])],1),n("v-col",[n("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.currentUser===this.$store.state.person.id,expression:"currentUser === this.$store.state.person.id"}],attrs:{text:"",color:"deep-purple accent-4"},on:{click:function(t){return e.deleteItem()}}},[e._v(" eliminar ")])],1)],1)],1)],1),n("v-row",{attrs:{justify:"center"}},[n("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"headline"},[e._v(e._s(e.formTitle))])]),n("v-card-subtitle",[e._v("En respuesta a : "+e._s(e.message.user)+" - "+e._s(e.message.date))]),n("v-card-text",[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12",sm:"12",md:"12"}},[n("v-textarea",{attrs:{outlined:"",name:"input-7-4",label:"Descripción",required:""},model:{value:e.editedItem.content,callback:function(t){e.$set(e.editedItem,"content",t)},expression:"editedItem.content"}})],1)],1)],1)],1),n("v-card-actions",[n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v("Close")]),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){return e.save()}}},[e._v("Save")])],1)],1)],1)],1),n("treeFolderContent",{attrs:{children:e.message.children}})],1)},r=[],a=(n("d3b7"),n("96cf"),n("1da1")),o=n("c6f2"),i={name:"treeFolder",data:function(){return{parentMessage:{id:"",date:"",user:""},currentUser:"",editedIndex:-1,dialog:!1,editedItem:{id:"",content:"",forum:"",date:"",parentMessage:"",user:"",children:[]},defaultItem:{id:"",content:"",forum:"",date:"",parentMessage:"",user:"",children:[]}}},created:function(){this.getUserOfForum()},computed:{formTitle:function(){return-1===this.editedIndex?"Nueva Respuesta":"Editar Respuesta"}},props:["message"],components:{treeFolderContent:function(){return n.e("chunk-5cda7fe3").then(n.bind(null,"3a9e"))}},watch:{dialog:function(e){e||this.close()}},methods:{timeConverter:function(e){var t=new Date,n=new Date(1e3*e),s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=t.getFullYear(),a=s[n.getMonth()],o=n.getDate(),i=n.getHours(),c=n.getMinutes(),l=n.getSeconds(),u=o+" "+a+" "+r+" "+i+":"+c+":"+l;return u},getUserOfForum:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.message,e.currentUser=n.user,t.next=4,o.db.collection("usuarios").doc(n.user).get().then((function(t){var n=t.data();e.message.user=n.nombre+" "+n.apellido}));case 4:e.getParentMessage();case 5:case"end":return t.stop()}}),t)})))()},getParentMessage:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o.db.collection("mensajes").doc(e.message.parent_message).get().then((function(t){var n=t.data();e.parentMessage.date=n.fecha,e.parentMessage.user=n.usuario,e.parentMessage.id=t.id}));case 2:return t.next=4,o.db.collection("usuarios").doc(e.parentMessage.user).get().then((function(t){var n=t.data();e.parentMessage.user=n.nombre+" "+n.apellido,e.parentMessage.date=e.timeConverter(e.parentMessage.date)}));case 4:case"end":return t.stop()}}),t)})))()},save:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:console.log(e.editedIndex),e.editedIndex>-1?e.updateMessage(e.editedItem):e.saveMessage(e.editedItem),e.close(),e.$router.push({name:"generalForum"});case 4:case"end":return t.stop()}}),t)})))()},saveMessage:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var s,r,a,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return s={contenido:e.content,fecha:new Date,foro:t.message.forum,mensaje_padre:t.message.id,usuario:t.$store.state.person.id,children:[]},console.log(s),r="",a=[],n.next=6,o.db.collection("mensajes").add(s).then((function(e){r=e.id,console.log("Document written with ID: ",e.id)})).catch((function(e){console.error("Error adding document: ",e)}));case 6:return n.next=8,o.db.collection("mensajes").doc(t.message.id).get().then((function(e){var t=e.data();a=t.children,a.push(r)}));case 8:return i={children:a},console.log(a),n.next=12,o.db.collection("mensajes").doc(t.message.id).update(i).then((function(){console.log("Document successfully updated!")})).catch((function(e){console.error("Error updating document: ",e)}));case 12:case"end":return n.stop()}}),n)})))()},updateMessage:function(e){var t={contenido:e.content};o.db.collection("mensajes").doc(this.message.id).update(t).then((function(){console.log("Document successfully updated!")})).catch((function(e){console.error("Error updating document: ",e)}))},edit:function(){this.editedIndex=1,this.editedItem=Object.assign({},this.message),this.dialog=!0},deleteItem:function(){var e=this.message.children.length;0==e?(confirm("¿Esta seguro que desea eliminar esta respuesta?")&&this.deleteMessage(this.message),this.$router.push({name:"generalForum"})):confirm("No es posible eliminar el comentario al tener mensajes relacionados")},deleteMessage:function(e){return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o.db.collection("mensajes").doc(e.id).delete().then((function(){alert("Document successfully deleted!")})).catch((function(e){console.error("Error removing document: ",e)}));case 2:case"end":return t.stop()}}),t)})))()},close:function(){var e=this;this.dialog=!1,setTimeout((function(){e.editedItem=Object.assign({},e.defaultItem),e.editedIndex=-1}),300)}}},c=i,l=(n("556e"),n("2877")),u=Object(l["a"])(c,s,r,!1,null,null,null);t["a"]=u.exports},c6f2:function(e,t,n){"use strict";n.r(t),n.d(t,"db",(function(){return o})),n.d(t,"usuarios",(function(){return i}));var s=n("59ca"),r=n.n(s),a=(n("e71f"),{apiKey:"AIzaSyC-R1Ds1_PF5SiDnBJmFS43GbTLqk-EEUk",authDomain:"foro-8955e.firebaseapp.com",databaseURL:"https://foro-8955e.firebaseio.com",projectId:"foro-8955e",storageBucket:"foro-8955e.appspot.com",messagingSenderId:"970214033059",appId:"1:970214033059:web:460d3d957eff1f32642116"});r.a.initializeApp(a);var o=r.a.firestore(),i=o.collection("usuarios")},db5e:function(e,t,n){},f5b2:function(e,t,n){}});
//# sourceMappingURL=app.81067b64.js.map